#!/bin/bash

module use --append /groups/ngolubev/Packages/modulefiles/
module add guk/7.0
gamess_bin=gamess

#create temporary directory
mkdir -p %TMP_DIR
cd %TMP_DIR

#perform SCF MP2 calculations; write output to gamess.out file
$gamess_bin << EOF > gamess.out
charge 0
geometry angstroms
$geometry{
 %X %Y %Z %AN %AL
};
end
BASIS 6-31G
SCFTYPE MP2
EOF

#search mp2 energy in output file
hf=`cat gamess.out | grep "total energy" | head -1 | awk '{print $3}'`
mp2=`cat gamess.out | grep "total energy (mp2)" | awk '{print $4}'`

#print output file
cat <<- EOF > %RUN_OUT
\$energy_HF
 $hf
\$energy_MP2
 $mp2
EOF
